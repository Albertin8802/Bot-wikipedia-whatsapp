const qrcode = require('qrcode-terminal');
const { Client, LocalAuth, MessageMedia } = require('whatsapp-web.js');
const wikipediaHandler = require('./complementos/wikipedia');
const terminalHandler = require('./complementos/terminal');

const client = new Client({
  authStrategy: new LocalAuth({
    clientId: "WikiBot" // Un identificador
  }),
  puppeteer: {
    args: [
      "--no-sandbox",
    ],
  },
});

client.initialize();

client.on('qr', (qr) => {
  qrcode.generate(qr, { small: true });
});

client.on('authenticated', () => {
  console.log('Cargando...');
});

client.on('ready', () => {
  console.log('âœ… CONECTADO AL WHATSAPP');
});

client.on('message', async (message) => {
  try {
    const body = message.body.toLowerCase(); // Convertir el contenido del mensaje a minÃºsculas

    // Verificar si el contenido del mensaje coincide con alguna de las variaciones aceptadas
    if (body === 'creador') {
      // Obtener el medio desde la URL
      const media = await MessageMedia.fromUrl(
        'https://media.discordapp.net/attachments/1102448933608886293/1111892241359851520/My_project-1.png'
      );

      // Responder con el medio
      client.sendMessage(message.from, media, {
        caption: '*Equipo de desarrollo VersiÃ³n Beta: 1.0.2*',
      });
    } else if (body.startsWith('wiki') || body.startsWith('wikipedia')) {
      // Manejar el comando de Wikipedia
      wikipediaHandler(client, message);
    }
  } catch (error) {
    console.error('âŒ Error en el complemento:', error);
  }
});

const gradient = require('gradient-string');

console.log(
  gradient('yellow', 'green')('âœ… Iniciando...') + '\n' +
  gradient('yellow', 'red')(`
 â–ˆ     â–ˆâ–‘ â–ˆâ–ˆâ–“ â–ˆâ–ˆ â–„â–ˆâ–€ â–ˆâ–ˆâ–“    â–„â–„â–„â–„    â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“    â–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–“â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ 
â–“â–ˆâ–‘ â–ˆ â–‘â–ˆâ–‘â–“â–ˆâ–ˆâ–’ â–ˆâ–ˆâ–„â–ˆâ–’ â–“â–ˆâ–ˆâ–’   â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’â–“  â–ˆâ–ˆâ–’ â–“â–’   â–“â–ˆâ–ˆâ–’â–€â–ˆâ–€ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–€ â–ˆâ–ˆâ–Œ
â–’â–ˆâ–‘ â–ˆ â–‘â–ˆ â–’â–ˆâ–ˆâ–’â–“â–ˆâ–ˆâ–ˆâ–„â–‘ â–’â–ˆâ–ˆâ–’   â–’â–ˆâ–ˆâ–’ â–„â–ˆâ–ˆâ–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–’ â–“â–ˆâ–ˆâ–‘ â–’â–‘   â–“â–ˆâ–ˆ    â–“â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ   â–ˆâ–Œ
â–‘â–ˆâ–‘ â–ˆ â–‘â–ˆ â–‘â–ˆâ–ˆâ–‘â–“â–ˆâ–ˆ â–ˆâ–„ â–‘â–ˆâ–ˆâ–‘   â–’â–ˆâ–ˆâ–‘â–ˆâ–€  â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘â–‘ â–“â–ˆâ–ˆâ–“ â–‘    â–’â–ˆâ–ˆ    â–’â–ˆâ–ˆ â–‘â–“â–ˆâ–„   â–Œ
â–‘â–‘â–ˆâ–ˆâ–’â–ˆâ–ˆâ–“ â–‘â–ˆâ–ˆâ–‘â–’â–ˆâ–ˆâ–’ â–ˆâ–„â–‘â–ˆâ–ˆâ–‘   â–‘â–“â–ˆ  â–€â–ˆâ–“â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘  â–’â–ˆâ–ˆâ–’ â–‘    â–’â–ˆâ–ˆâ–’   â–‘â–ˆâ–ˆâ–’â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–“ 
â–‘ â–“â–‘â–’ â–’  â–‘â–“  â–’ â–’â–’ â–“â–’â–‘â–“     â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–€â–’â–‘ â–’â–‘â–’â–‘â–’â–‘   â–’ â–‘â–‘      â–‘ â–’â–‘   â–‘  â–‘ â–’â–’â–“  â–’ 
  â–’ â–‘ â–‘   â–’ â–‘â–‘ â–‘â–’ â–’â–‘ â–’ â–‘   â–’â–‘â–’   â–‘   â–‘ â–’ â–’â–‘     â–‘       â–‘  â–‘      â–‘ â–‘ â–’  â–’ 
  â–‘   â–‘   â–’ â–‘â–‘ â–‘â–‘ â–‘  â–’ â–‘    â–‘    â–‘ â–‘ â–‘ â–‘ â–’    â–‘         â–‘      â–‘    â–‘ â–‘  â–‘ 
    â–‘     â–‘  â–‘  â–‘    â–‘      â–‘          â–‘ â–‘                     â–‘      â–‘    
                                 â–‘                                  â–‘      
  `) + '\n' +
  gradient('yellow', 'red')(`
  â–„ .â–„      .â–„â–„ Â· â–„â–„â–„â–„â–„â–ª   â– â–„  â–„â–„ â€¢     â–„â–„â–„â–„Â·  â–„Â· â–„â–Œ    â–„â–„â–„â–„Â·       â–â–„â€¢ â–„ â€¢ â–Œ â–„ Â·. â–ª   â– â–„ â–„â–„â–„ .â–„â–„â–Œ â– â–„â–Œ      â–„â–„â–„  â–„â–„â–Œ  Â·â–„â–„â–„â–„  
  â–ˆâ–ˆâ–ªâ–â–ˆâ–ª     â–â–ˆ â–€. â€¢â–ˆâ–ˆ  â–ˆâ–ˆ â€¢â–ˆâ–Œâ–â–ˆâ–â–ˆ â–€ â–ª    â–â–ˆ â–€â–ˆâ–ªâ–â–ˆâ–ªâ–ˆâ–ˆâ–Œ    â–â–ˆ â–€â–ˆâ–ªâ–ª      â–ˆâ–Œâ–ˆâ–Œâ–ªÂ·â–ˆâ–ˆ â–â–ˆâ–ˆâ–ˆâ–ªâ–ˆâ–ˆ â€¢â–ˆâ–Œâ–â–ˆâ–€â–„.â–€Â·â–ˆâ–ˆÂ· â–ˆâ–Œâ–â–ˆâ–ª     â–€â–„ â–ˆÂ·â–ˆâ–ˆâ€¢  â–ˆâ–ˆâ–ª â–ˆâ–ˆ 
  â–ˆâ–ˆâ–€â–â–ˆ â–„â–ˆâ–€â–„ â–„â–€â–€â–€â–ˆâ–„ â–â–ˆ.â–ªâ–â–ˆÂ·â–â–ˆâ–â–â–Œâ–„â–ˆ â–€â–ˆâ–„    â–â–ˆâ–€â–€â–ˆâ–„â–â–ˆâ–Œâ–â–ˆâ–ª    â–â–ˆâ–€â–€â–ˆâ–„ â–„â–ˆâ–€â–„  Â·â–ˆâ–ˆÂ· â–â–ˆ â–Œâ–â–Œâ–â–ˆÂ·â–â–ˆÂ·â–â–ˆâ–â–â–Œâ–â–€â–€â–ªâ–„â–ˆâ–ˆâ–ªâ–â–ˆâ–â–â–Œ â–„â–ˆâ–€â–„ â–â–€â–€â–„ â–ˆâ–ˆâ–ª  â–â–ˆÂ· â–â–ˆâ–Œ
  â–ˆâ–ˆâ–Œâ–â–€â–â–ˆâ–Œ.â–â–Œâ–â–ˆâ–„â–ªâ–â–ˆ â–â–ˆâ–ŒÂ·â–â–ˆâ–Œâ–ˆâ–ˆâ–â–ˆâ–Œâ–â–ˆâ–„â–ªâ–â–ˆ    â–ˆâ–ˆâ–„â–ªâ–â–ˆ â–â–ˆâ–€Â·.    â–ˆâ–ˆâ–„â–ªâ–â–ˆâ–â–ˆâ–Œ.â–â–Œâ–ªâ–â–ˆÂ·â–ˆâ–Œâ–ˆâ–ˆ â–ˆâ–ˆâ–Œâ–â–ˆâ–Œâ–â–ˆâ–Œâ–ˆâ–ˆâ–â–ˆâ–Œâ–â–ˆâ–„â–„â–Œâ–â–ˆâ–Œâ–ˆâ–ˆâ–â–ˆâ–Œâ–â–ˆâ–Œ.â–â–Œâ–â–ˆâ€¢â–ˆâ–Œâ–â–ˆâ–Œâ–â–Œâ–ˆâ–ˆ. â–ˆâ–ˆ 
  â–€â–€â–€ Â· â–€â–ˆâ–„â–€â–ª â–€â–€â–€â–€  â–€â–€â–€ â–€â–€â–€â–€â–€ â–ˆâ–ªÂ·â–€â–€â–€â–€     Â·â–€â–€â–€â–€   â–€ â€¢     Â·â–€â–€â–€â–€  â–€â–ˆâ–„â–€â–ªâ€¢â–€â–€ â–€â–€â–€â–€  â–ˆâ–ªâ–€â–€â–€â–€â–€â–€â–€â–€ â–ˆâ–ª â–€â–€â–€  â–€â–€â–€â–€ â–€â–ª â–€â–ˆâ–„â–€â–ª.â–€  â–€.â–€â–€â–€ â–€â–€â–€â–€â–€â€¢
  `) + '\n' +
  gradient('red', 'firebrick')("		â€”(â€¢â€¢Ã·[ 'ğ•ğ•šğ•œğ•šğ”¹ğ• ğ•¥' ğ•“ğ•ª ğ”¸ğ•ğ•“ğ•–ğ•£ğ•¥ğ•šğ•Ÿ#ğŸ ğŸ ğŸ˜ğŸš ]Ã·â€¢â€¢)â€”")
);

client.on('message', (message) => {
  try {
    terminalHandler(message, { client });
  } catch (error) {
    console.error('âŒ Error en el complemento:', error);
  }
});
